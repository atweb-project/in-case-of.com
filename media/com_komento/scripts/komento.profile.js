Komento.module("komento.profile",function(a){var b=this;Komento.require().script("komento.common").done(function(){Komento.Controller("Profile",{defaults:{uid:0,"{navActivities}":".navActivities","{navPopular}":".navPopular","{navSticked}":".navSticked","{navs}":".navs","{tabs}":".tabs","{activitiesTab}":"#kmt-activities","{popularTab}":"#kmt-popular","{stickedTab}":"#kmt-sticked","{loadMore}":".loadMore"}},function(b){return{init:function(){b.navs(":eq(0)").trigger("click"),b.loaded={},b.total={}},"{navs} click":function(c){var d=a(c).attr("func"),e=a(c).attr("tab");b.tabs().hide(),a("#"+e).show(),b.navs().removeClass("active"),c.addClass("active"),b[d]()},"{loadMore} click":function(a){if(a.checkClick()){var c=a.parents(".tabs").attr("id").substring(4),d="loadMore"+c.charAt(0).toUpperCase()+c.slice(1);b[d]()}},loadActivities:function(){b.activitiesTab().attr("loaded")||(b.activitiesTab().html('<img src="'+Komento.options.spinner+'" />'+a.language("COM_KOMENTO_LOADING")),Komento.ajax("site.views.profile.getactivities",{uid:b.options.uid},{success:function(a,c,d){b.activitiesTab().html(a),b.activitiesTab().attr("loaded",!0),b.loaded.activities=parseInt(c),b.total.activities=parseInt(d)},fail:function(){}}))},loadMoreActivities:function(){Komento.ajax("site.views.profile.getactivities",{loadMore:1,uid:b.options.uid,start:b.loaded.activities},{success:function(a,c,d){b.activitiesTab().children("ul").append(a),b.loaded.activities+=parseInt(c),b.loaded.activities>=b.total.activities&&b.hideLoadMore("activities"),b.loadMore().enable()},fail:function(){}})},loadPopular:function(){b.popularTab().attr("loaded")||(b.popularTab().html('<img src="'+Komento.options.spinner+'" />'+a.language("COM_KOMENTO_LOADING")),Komento.ajax("site.views.profile.getpopularcomments",{uid:b.options.uid},{success:function(a,c,d){b.popularTab().html(a),b.popularTab().attr("loaded",!0),b.loaded.popular=parseInt(c),b.total.popular=parseInt(d)},fail:function(){}}))},loadMorePopular:function(){Komento.ajax("site.views.profile.getpopularcomments",{loadMore:1,uid:b.options.uid,start:b.loaded.popular},{success:function(a,c,d){b.popularTab().children("ul").append(a),b.loaded.popular+=parseInt(c),b.loaded.popular>=b.total.popular&&b.hideLoadMore("popular"),b.loadMore().enable()},fail:function(){}})},loadSticked:function(){b.stickedTab().attr("loaded")||(b.stickedTab().html('<img src="'+Komento.options.spinner+'" />'+a.language("COM_KOMENTO_LOADING")),Komento.ajax("site.views.profile.getstickedcomments",{uid:b.options.uid},{success:function(a,c,d){b.stickedTab().html(a),b.stickedTab().attr("loaded",!0),b.loaded.sticked=parseInt(c),b.total.sticked=parseInt(d)},fail:function(){}}))},loadMoreSticked:function(){Komento.ajax("site.views.profile.getstickedcomments",{loadMore:1,uid:b.options.uid,start:b.loaded.sticked},{success:function(a,c,d){b.stickedTab().children("ul").append(a),b.loaded.sticked+=parseInt(c),b.loaded.sticked>=b.total.sticked&&b.hideLoadMore("sticked"),b.loadMore().enable()},fail:function(){}})},hideLoadMore:function(b){a("#kmt-"+b).find(".loadMore").remove()}}}),b.resolve()})});